{% extends "base.html" %}
{% block title %}AI Jury — Chat{% endblock %}
{% block content %}

<div class="h-[calc(100vh-8rem)] -mx-4 sm:-mx-6 lg:-mx-8">
    <div class="grid grid-cols-12 gap-0 h-full">
        <!-- Sidebar -->
        <aside class="col-span-12 md:col-span-3 xl:col-span-2 border-r border-zinc-200 bg-white/80 backdrop-blur-sm h-full">
            <div class="flex h-full flex-col">
                <!-- Sidebar header -->
                <div class="px-4 py-4 border-b border-zinc-200">
                    <div class="flex items-center justify-between">
                        <h2 class="text-sm font-semibold text-zinc-800">Chats</h2>
                        <button class="inline-flex items-center rounded-md bg-indigo-600 px-2.5 py-1.5 text-xs font-semibold text-white shadow-sm ring-1 ring-inset ring-indigo-500/40 hover:bg-indigo-700 transition" onclick="addNewChat()">New</button>
                    </div>
                    <div class="mt-3">
                        <div class="relative">
                            <input type="text" placeholder="Search chats" class="w-full rounded-md border border-zinc-200 bg-white px-3 py-1.5 text-sm text-zinc-800 placeholder-zinc-400 focus:outline-none focus:ring-2 focus:ring-indigo-200">
                            <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-zinc-400">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-4 w-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 21l-4.3-4.3M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z"/></svg>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat list -->
                <div id="chat-list" class="flex-1 overflow-y-auto divide-y divide-zinc-100">
                    <!-- Example chat items -->
                    <button class="w-full text-left px-4 py-3 hover:bg-zinc-50 focus:bg-zinc-50 transition">
                        <p class="text-sm font-medium text-zinc-800 truncate">Case analysis — Contract dispute</p>
                        <p class="text-xs text-zinc-500 truncate">Yesterday • 12 messages</p>
                    </button>
                    <button class="w-full text-left px-4 py-3 hover:bg-zinc-50 focus:bg-zinc-50 transition">
                        <p class="text-sm font-medium text-zinc-800 truncate">Upload: Court filing.pdf</p>
                        <p class="text-xs text-zinc-500 truncate">2 days ago • 8 messages</p>
                    </button>
                </div>

                <!-- Sidebar footer -->
                <div class="px-4 py-4 border-t border-zinc-200">
                    <a href="#" class="inline-flex items-center gap-2 text-xs text-zinc-600 hover:text-zinc-800">
                        <span class="inline-flex h-5 w-5 items-center justify-center rounded bg-indigo-600 text-white ring-1 ring-indigo-500/40">AI</span>
                        AI Jury Chat
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main chat area -->
        <section class="col-span-12 md:col-span-9 xl:col-span-10 h-full">
            <div class="flex h-full flex-col">
                <!-- Conversation header -->
                <div class="sticky top-0 z-10 border-b border-zinc-200 bg-white/70 backdrop-blur px-4 py-3">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <div class="inline-flex h-7 w-7 items-center justify-center rounded-md bg-indigo-600 text-white ring-1 ring-indigo-500/40">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-4 w-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v3m0 12v3m0-15a9 9 0 0 1 9 9m-9-9a9 9 0 0 0-9 9"/></svg>
                            </div>
                            <h3 class="text-sm font-semibold text-zinc-800">New chat</h3>
                        </div>
                        <div class="flex items-center gap-2">
                            <button class="rounded-md px-2.5 py-1.5 text-xs font-medium text-zinc-600 ring-1 ring-inset ring-zinc-200 hover:bg-zinc-50">Clear</button>
                            <button class="rounded-md px-2.5 py-1.5 text-xs font-medium text-zinc-600 ring-1 ring-inset ring-zinc-200 hover:bg-zinc-50">Export</button>
                        </div>
                    </div>
                </div>

                <!-- Messages -->
                <div id="messages" class="flex-1 overflow-y-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6">
                    <!-- Assistant message -->
                    <div class="flex items-start gap-3">
                        <div class="mt-0.5 inline-flex h-8 w-8 items-center justify-center rounded-md bg-indigo-600 text-white ring-1 ring-indigo-500/40">AI</div>
                        <div class="flex-1">
                            <div class="prose prose-zinc max-w-none">
                                <p class="text-sm text-zinc-800">Hi! I’m your AI assistant for judiciary insights. Upload a case file or describe your query to begin.</p>
                            </div>
                            <div class="mt-2 text-[11px] text-zinc-500">model: gpt-4o-mini • 2s ago</div>
                        </div>
                    </div>

                    <!-- User message -->
                    <div class="flex items-start gap-3">
                        <div class="mt-0.5 inline-flex h-8 w-8 items-center justify-center rounded-md bg-zinc-200 text-zinc-700 ring-1 ring-zinc-300">U</div>
                        <div class="flex-1">
                            <div class="rounded-xl ring-1 ring-zinc-200 bg-white px-4 py-3 shadow-sm">
                                <p class="text-sm text-zinc-800">Summarize the attached contract dispute and identify key precedents.</p>
                            </div>
                            <div class="mt-2 text-[11px] text-zinc-500">you • 1s ago</div>
                        </div>
                    </div>

                    <!-- Assistant message with blocks -->
                    <div class="flex items-start gap-3">
                        <div class="mt-0.5 inline-flex h-8 w-8 items-center justify-center rounded-md bg-indigo-600 text-white ring-1 ring-indigo-500/40">AI</div>
                        <div class="flex-1">
                            <div class="rounded-xl ring-1 ring-zinc-200 bg-white px-4 py-4 shadow-sm">
                                <div class="space-y-3">
                                    <p class="text-sm text-zinc-800">Here’s an outline of the dispute and likely precedents:</p>
                                    <ul class="list-disc pl-5 text-sm text-zinc-700">
                                        <li>Formation and consideration issues</li>
                                        <li>Breach and materiality</li>
                                        <li>Remedy scope and mitigation</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="mt-2 flex items-center gap-3 text-[11px] text-zinc-500">
                                <span>AI Jury • just now</span>
                                <span class="inline-flex items-center gap-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-3.5 w-3.5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 6v6l4 2"/></svg>
                                    thinking time: 1.3s
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Composer -->
                <div class="border-t border-zinc-200 bg-white/80 px-4 sm:px-6 lg:px-8 py-4">
                    <form class="mx-auto max-w-3xl" onsubmit="sendMessage(event)">
                        <div class="flex items-end gap-3">
                            <div class="flex-1">
                                <div class="relative">
                                    <textarea id="chat-input" rows="1" placeholder="Message AI Jury…" class="w-full resize-none rounded-xl border border-zinc-200 bg-white px-4 py-3 pr-12 text-sm text-zinc-800 placeholder-zinc-400 shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-200" oninput="autoResize(this)"></textarea>
                                    <div class="absolute bottom-3 right-3 flex items-center gap-2">
                                        <button type="button" title="Attach" class="rounded-md px-2.5 py-1.5 text-xs font-medium text-zinc-600 ring-1 ring-inset ring-zinc-200 hover:bg-zinc-50">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-4 w-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M21 12v5a5 5 0 0 1-10 0V7a3 3 0 1 1 6 0v9a1 1 0 0 1-2 0V8"/></svg>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="inline-flex items-center rounded-xl bg-indigo-600 px-4 py-2.5 text-sm font-semibold text-white shadow-sm ring-1 ring-inset ring-indigo-500/40 hover:bg-indigo-700 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="mr-2 h-4 w-4"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 12h14M12 5l7 7-7 7"/></svg>
                                Send
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </div>
</div>

<script>
function autoResize(el){
    el.style.height = 'auto';
    el.style.height = Math.min(el.scrollHeight, 200) + 'px';
}
function sendMessage(e){
    e.preventDefault();
    var input = document.getElementById('chat-input');
    if(!input.value.trim()) return;
    var messages = document.getElementById('messages');
    var wrapper = document.createElement('div');
    wrapper.className = 'flex items-start gap-3';
    wrapper.innerHTML = '<div class="mt-0.5 inline-flex h-8 w-8 items-center justify-center rounded-md bg-zinc-200 text-zinc-700 ring-1 ring-zinc-300">U</div>'+
        '<div class="flex-1">'+
        '<div class="rounded-xl ring-1 ring-zinc-200 bg-white px-4 py-3 shadow-sm">'+
        '<p class="text-sm text-zinc-800"></p>'+
        '</div>'+ 
        '<div class="mt-2 text-[11px] text-zinc-500">you • just now</div>'+ 
        '</div>';
    wrapper.querySelector('p').textContent = input.value;
    messages.appendChild(wrapper);
    messages.scrollTop = messages.scrollHeight;
    input.value='';
    autoResize(input);
}
function addNewChat(){
    var list = document.getElementById('chat-list');
    var btn = document.createElement('button');
    btn.className = 'w-full text-left px-4 py-3 hover:bg-zinc-50 focus:bg-zinc-50 transition';
    btn.innerHTML = '<p class="text-sm font-medium text-zinc-800 truncate">New chat</p><p class="text-xs text-zinc-500 truncate">just now</p>';
    list.prepend(btn);
}
</script>

{% endblock %}


